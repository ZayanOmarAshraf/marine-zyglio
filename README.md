# Zyglio


**URL**: https://lovable.dev/projects/9aa278e3-baff-4127-b8c2-b5009b34d2e6

- **Voice Recording & Transcription**: Record procedures using voice commands and get automatic transcription
- **Task Definition**: Define tasks with KPIs, presenter information, and objectives
- **Media Library**: Upload and organize supporting materials (images, videos, PDFs)
- **Procedural Steps**: Organize procedures into clear, sequential steps
- **AI Assistance**: Get AI-suggested clarifications and questions
- **YAML Generation**: Automatically generate structured YAML schema of procedures
- **Flowchart Visualization**: View procedures as interactive flowcharts
- **Simulation Building**: Create voice-first simulation experiences

## Technology Stack

- **Frontend**: Next.js, React, TypeScript, Tailwind CSS
- **UI Components**: Shadcn UI
- **Database**: PostgreSQL (via Supabase)
- **ORM**: Prisma
- **Authentication**: Supabase Auth
- **Storage**: Supabase Storage

## Getting Started

### Prerequisites

- Node.js (v18 or higher)
- npm or yarn
- PostgreSQL database (local or Supabase)

### Installation

1. Clone the repository:
   ```
   git clone https://github.com/yourusername/voice-procedural-craftsman.git
   cd voice-procedural-craftsman
   ```

2. Install dependencies:
   ```
   npm install
   ```

3. Set up environment variables:
   Create a `.env` file in the root directory with the following content:
   ```
   # Prisma
   DATABASE_URL="postgresql://username:password@localhost:5432/voice_procedural_db"
   
   # Supabase
   NEXT_PUBLIC_SUPABASE_URL=your-supabase-url
   NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
   ```

4. Run Prisma migrations:
   ```
   npx prisma migrate dev
   ```

5. Start the development server:
   ```
   npm run dev
   ```

6. Open [http://localhost:3000](http://localhost:3000) in your browser.

## Project Structure

- `/src/app`: Next.js app router pages and API routes
- `/src/components`: Reusable React components
- `/src/lib`: Utility functions and libraries
- `/prisma`: Prisma schema and migrations
- `/public`: Static assets

## Database Structure

The database schema includes models for:

- Users
- Learning Tasks
- Media Items
- Dictations
- AI Suggestions
- Procedures and Steps
- Flowcharts
- Simulations
- Documents and Chunks (for RAG system)

## RAG (Retrieval-Augmented Generation) System

The application features a RAG system that enhances the procedure creation process with contextually relevant information.

### Setup RAG

1. Enable the pgvector extension in your PostgreSQL database:

```sql
CREATE EXTENSION IF NOT EXISTS vector;
```

2. Create the match_chunks function for vector similarity search:

```sql
CREATE OR REPLACE FUNCTION match_chunks(
  query_embedding vector(1536),
  match_threshold float,
  match_count int
)
RETURNS TABLE (
  id uuid,
  document_id uuid,
  text text,
  similarity float,
  sequence_number int
)
LANGUAGE plpgsql
AS $$
BEGIN
  RETURN QUERY
  SELECT
    c.id::uuid,
    c."documentId"::uuid as document_id,
    c.text,
    1 - (c.embedding <=> query_embedding) as similarity,
    c."sequenceNumber" as sequence_number
  FROM "Chunk" c
  WHERE 1 - (c.embedding <=> query_embedding) > match_threshold
  ORDER BY c.embedding <=> query_embedding
  LIMIT match_count;
END;
$$;
```

3. Install Python dependencies for data ingestion:

```bash
cd scripts
pip install -r requirements.txt
```

4. Add your DeepSeek API key to the `.env` file:

```
DEEPSEEK_API_KEY=your_deepseek_api_key_here
```

5. Run the data ingestion script:

```bash
python scripts/ingest_data.py
```

### How the RAG System Works

1. **Task Definition to Interview**: After defining a procedure task, the system retrieves relevant context from the document database.

2. **AI-Powered Interview**: A voice interview is conducted with contextually informed questions generated by DeepSeek.

3. **Dynamic Content Retrieval**: During the interview, the system retrieves additional context based on the SME's responses.

4. **Knowledge Transfer**: The insights from the interview are used to populate the dictation/procedure steps.

## Development Workflow

1. Define a Learning Task with KPIs
2. Upload supporting media
3. Participate in the AI-driven interview (powered by RAG)
4. Record and transcribe procedure steps
5. Organize steps with AI assistance
6. Generate flowcharts and YAML
7. Create simulations



